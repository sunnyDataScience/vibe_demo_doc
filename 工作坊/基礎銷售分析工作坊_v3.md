# AI Vibe Coding 工作坊：基礎銷售分析實戰 v3

> **模組 1 專項入門版** | Supermarket Sales 1000筆數據 | 6 小時零基礎友善
> 目標：從 Excel 思維無痛轉換到 Python 自動化分析

---

## 🎯 工作坊核心定位

```
課程主題：超市銷售資料分析自動化
資料來源：Supermarket Sales Dataset（1,000筆精選數據）
技術棧：Python + Pandas + Matplotlib/Seaborn + Streamlit
交付物：分店績效表 + 產品線排名 + 時間趨勢圖 + 互動式儀表板
成功指標：95% 學員能完成基礎分析並部署簡單儀表板
適合對象：Excel 中級使用者、Python 零基礎、想要自動化日常報表
```

---

## 📊 資料集規格

| 項目 | 規格 |
|:-----|:-----|
| **資料集名稱** | Supermarket Sales |
| **資料量** | 1,000 筆交易紀錄 |
| **時間跨度** | 2019 年 Q1（3個月） |
| **欄位數** | 17 個關鍵欄位 |
| **分店數** | 3 家分店（A, B, C） |
| **產品線數** | 6 條產品線 |
| **客戶類型** | 2 類（Member/Normal） |
| **清潔度** | 100%（無缺失值） |

### 資料欄位說明

```python
# 核心欄位（中英對照）
- Invoice ID: 發票編號
- Branch: 分店代碼（A/B/C）
- City: 城市（Yangon/Mandalay/Naypyidaw）
- Customer type: 客戶類型（Member/Normal）
- Gender: 性別
- Product line: 產品線（6類）
- Unit price: 單價
- Quantity: 數量
- Tax 5%: 稅額
- Total: 總金額（含稅）
- Date: 日期
- Time: 時間
- Payment: 付款方式（Cash/Credit card/Ewallet）
- COGS: 銷貨成本
- Gross margin percentage: 毛利率
- Gross income: 毛利
- Rating: 客戶評分（1-10）
```

---

## 🏗️ 課程架構設計（6 小時版）

### 整體時間配置

| 階段 | 時間 | 內容 | 產出 |
|:-----|:-----|:-----|:-----|
| **暖身階段** | 09:00-10:00 | Excel vs Python + 環境設定 | Hello Analytics |
| **基礎階段** | 10:00-11:30 | 資料讀取與探索 | 資料概覽報告 |
| **午餐休息** | 11:30-12:30 | — | — |
| **核心階段** | 12:30-14:30 | 三大分析實作 | 分店/產品/時間分析 |
| **視覺階段** | 14:30-15:30 | 圖表製作 | 5 種關鍵圖表 |
| **部署階段** | 15:30-16:30 | Streamlit 儀表板 | 線上互動報表 |
| **Demo Time** | 16:30-17:00 | 成果展示 | 2分鐘展示 |

---

## 📚 模組化教學設計

### 🔥 Module 0：開場與環境準備（60 分鐘）

#### 0-1 簽到破冰（09:00-09:15）

```
【活動】Excel 痛點大聲說
【問題】「每月做報表最煩的是什麼？」
【收集】白板寫下 Top 5 痛點
【對照】展示 Python 能怎麼解決

常見痛點範例：
1. VLOOKUP 跨 10 個檔案要開到死機
2. 樞紐分析表每次都要重拉
3. 圖表格式調到眼花
4. 公式太長看不懂在算什麼
5. 檔案太大開不起來
```

#### 0-2 Before/After Demo（09:15-09:30）

```
【Live Demo】同一份報表的兩種做法

Excel 做法（5 分鐘）：
1. 開啟 3 個 Excel 檔
2. 手動 VLOOKUP
3. 建立樞紐分析表
4. 調整圖表格式
5. 複製貼上到 PowerPoint

Python 做法（30 秒）：
1. 執行 python sales_report.py
2. 打開 http://localhost:8501
3. 完成！

【震撼教育】讓學員看到差異
```

#### 0-3 環境設定與測試（09:30-10:00）

```python
【題目】安裝並測試 Python 環境
【情境】工欲善其事，必先利其器

【步驟】
1. 安裝 Anaconda（已預裝則跳過）
2. 開啟 Jupyter Notebook
3. 測試基礎套件
4. 第一行程式碼

【測試程式碼】
import pandas as pd
import matplotlib.pyplot as plt
print("恭喜！你的 Python 分析環境已就緒 🎉")
print(f"Pandas 版本：{pd.__version__}")

# 試著創建你的第一個 DataFrame
data = {
    '產品': ['咖啡', '麵包', '蛋糕'],
    '銷量': [100, 80, 60],
    '單價': [120, 50, 150]
}
df = pd.DataFrame(data)
df['營業額'] = df['銷量'] * df['單價']
print(df)

【DoD】
□ Jupyter 能開啟
□ 能執行上述程式碼
□ 看到 DataFrame 輸出

【Fallback】
- 安裝失敗 → Google Colab 備案
- import 錯誤 → 提供 environment.yml
```

---

### 📊 Module 1：資料讀取與初探（90 分鐘）

#### 1-1 暖身題：讀取銷售資料（10:00-10:20）

```python
【題目】把 CSV 讀進來看看長什麼樣
【情境】老闆丟了一份 Q1 銷售資料給你

【任務】
1. 讀取 supermarket_sales.csv
2. 查看前 5 筆資料
3. 了解資料維度（幾列幾欄）
4. 查看資料類型

【程式碼框架】
import pandas as pd

# TODO: 讀取 CSV 檔案
df = pd.read_csv(_____)

# TODO: 顯示前 5 筆
print(df._____)

# TODO: 顯示資料形狀
print(f"資料共有 {____} 列，{____} 欄")

# TODO: 顯示資料類型
print(df._____)

【DoD】
□ 成功讀取 1000 筆資料
□ 能說出有幾個欄位
□ 識別出數值欄位 vs 文字欄位

【Fallback】
- 路徑錯誤 → 提供絕對路徑
- 編碼錯誤 → 加入 encoding='utf-8'

【Prompt 提示】
「用 pandas 讀取 supermarket_sales.csv，
 顯示基本資訊包含形狀、前5筆、資料類型」
```

#### 1-2 核心題：資料探索與清理檢查（10:20-11:00）

```python
【題目】像偵探一樣了解你的資料
【情境】在 Excel 你會先看什麼？在 Python 也一樣

【探索清單】
1. 基本統計（最大/最小/平均）
2. 缺失值檢查
3. 重複值檢查
4. 異常值識別
5. 資料分布

【程式碼任務】
# 1. 基本統計描述
print(df.describe())

# 2. 檢查缺失值
print(df.isnull().sum())

# 3. 檢查重複的發票
duplicates = df[df.duplicated('Invoice ID')]
print(f"重複發票數：{len(duplicates)}")

# 4. 檢查異常值（如：負數數量、評分超過10）
print(f"負數數量訂單：{len(df[df['Quantity'] < 0])}")
print(f"異常評分：{len(df[(df['Rating'] < 1) | (df['Rating'] > 10)])}")

# 5. 各分店銷售筆數
print(df['Branch'].value_counts())

【進階探索】
# 日期處理
df['Date'] = pd.to_datetime(df['Date'])
df['Month'] = df['Date'].dt.month
df['Weekday'] = df['Date'].dt.day_name()

# 新增有用欄位
df['Hour'] = pd.to_datetime(df['Time']).dt.hour
df['Revenue'] = df['Quantity'] * df['Unit price']

【DoD】
□ 確認無缺失值
□ 確認無重複發票
□ 日期欄位轉換成 datetime
□ 新增至少 2 個分析欄位

【Fallback】
- describe() 看不懂 → 解釋每個統計值意義
- 日期轉換失敗 → 提供正確格式字串
```

#### 1-3 挑戰題：對比 Excel 做法（11:00-11:30）

```python
【題目】用 Python 重現 Excel 常用功能
【情境】向 Excel 高手證明 Python 也能做到

【Excel → Python 對照表】
1. 篩選：df[df['Branch'] == 'A']
2. 排序：df.sort_values('Total', ascending=False)
3. SUMIF：df[df['Branch'] == 'A']['Total'].sum()
4. 樞紐：df.pivot_table(values='Total', index='Branch', columns='Product line', aggfunc='sum')
5. VLOOKUP：pd.merge(df1, df2, on='key')

【實作任務】
# 任務1：找出分店A的會員客戶消費總額
result1 = df[(df['Branch'] == 'A') & (df['Customer type'] == 'Member')]['Total'].sum()

# 任務2：各產品線的平均評分（像樞紐分析表）
result2 = df.pivot_table(values='Rating', index='Product line', aggfunc='mean')

# 任務3：找出消費金額 Top 10 的交易
result3 = df.nlargest(10, 'Total')[['Invoice ID', 'Total', 'Product line']]

【DoD】
□ 完成 3 個 Excel 常見操作
□ 能說明比 Excel 快在哪裡
```

---

### 💼 Module 2：三大核心分析（120 分鐘）

#### 2-1 分店績效分析（12:30-13:10）

```python
【題目】比較 ABC 三家分店的表現
【情境】總經理要看各分店 Q1 績效

【分析維度】
1. 總營業額排名
2. 平均客單價
3. 客戶類型分布
4. 付款方式偏好
5. 熱門產品線差異

【程式碼實作】
# 1. 分店總營業額
branch_revenue = df.groupby('Branch')['Total'].agg([
    ('總營業額', 'sum'),
    ('交易筆數', 'count'),
    ('平均客單價', 'mean')
]).round(2)

# 2. 分店 x 客戶類型 交叉分析
branch_customer = pd.crosstab(
    df['Branch'],
    df['Customer type'],
    values=df['Total'],
    aggfunc='sum',
    normalize='index'  # 轉換成百分比
).round(2) * 100

# 3. 各分店最受歡迎產品
def top_product(group):
    return group.groupby('Product line')['Total'].sum().nlargest(1)

top_products = df.groupby('Branch').apply(top_product)

# 4. 製作分店績效卡
def create_branch_card(branch):
    branch_data = df[df['Branch'] == branch]
    card = {
        '分店': branch,
        '總營業額': f"${branch_data['Total'].sum():,.0f}",
        '平均評分': f"{branch_data['Rating'].mean():.1f}",
        '最佳產品': branch_data.groupby('Product line')['Total'].sum().idxmax(),
        '尖峰時段': branch_data.groupby('Hour')['Total'].sum().idxmax()
    }
    return pd.Series(card)

performance_cards = pd.DataFrame([create_branch_card(b) for b in ['A', 'B', 'C']])

【DoD】
□ 產出分店排名表
□ 識別各分店特色
□ 提出改善建議

【Fallback】
- groupby 不熟 → 畫圖解釋分組邏輯
- crosstab 不會 → 改用 pivot_table
```

#### 2-2 產品線分析（13:10-13:50）

```python
【題目】找出明星商品與滯銷品
【情境】採購部門要決定下季進貨策略

【分析任務】
1. 產品線銷售排名
2. 毛利貢獻度分析
3. 產品線 x 性別偏好
4. 產品評分分析
5. 關聯銷售分析

【程式碼實作】
# 1. 產品線綜合績效表
product_performance = df.groupby('Product line').agg({
    'Total': ['sum', 'mean', 'count'],
    'Gross income': 'sum',
    'Rating': 'mean',
    'Quantity': 'sum'
}).round(2)

# 重新命名欄位（更易讀）
product_performance.columns = ['總營收', '平均客單', '交易數', '毛利', '評分', '銷量']
product_performance['毛利率'] = (product_performance['毛利'] / product_performance['總營收'] * 100).round(1)

# 2. 性別偏好分析（哪些產品男女有別）
gender_preference = pd.crosstab(
    df['Product line'],
    df['Gender'],
    values=df['Total'],
    aggfunc='sum',
    normalize='columns'
) * 100

# 3. 找出需要促銷的產品（低銷量 + 低評分）
df['需促銷'] = (df['Quantity'] < df['Quantity'].median()) & (df['Rating'] < 7)
promo_products = df[df['需促銷']]['Product line'].value_counts()

# 4. BCG 矩陣分類（明星/金牛/問題/瘦狗）
avg_revenue = product_performance['總營收'].mean()
avg_growth = product_performance['交易數'].mean()  # 用交易數代表成長性

def classify_product(row):
    if row['總營收'] > avg_revenue and row['交易數'] > avg_growth:
        return '明星產品'
    elif row['總營收'] > avg_revenue and row['交易數'] <= avg_growth:
        return '金牛產品'
    elif row['總營收'] <= avg_revenue and row['交易數'] > avg_growth:
        return '問題產品'
    else:
        return '瘦狗產品'

product_performance['BCG分類'] = product_performance.apply(classify_product, axis=1)

【DoD】
□ 產出產品線排名
□ 識別明星與瘦狗產品
□ 提供進貨建議

【Fallback】
- BCG 矩陣不懂 → 簡化為高低銷量分類
- agg 複雜 → 分開計算再合併
```

#### 2-3 時間趨勢分析（13:50-14:30）

```python
【題目】找出銷售規律，預測忙閒時段
【情境】店長要優化排班，財務要預測現金流

【分析維度】
1. 每日銷售趨勢
2. 週間規律（週一到週日）
3. 時段分析（尖峰離峰）
4. 月度成長率
5. 節日效應

【程式碼實作】
# 1. 每日銷售趨勢
daily_sales = df.groupby('Date')['Total'].sum().reset_index()
daily_sales['MA7'] = daily_sales['Total'].rolling(window=7).mean()  # 7日移動平均

# 2. 星期幾的規律
df['Weekday'] = df['Date'].dt.day_name()
df['WeekdayNum'] = df['Date'].dt.dayofweek  # 0=Monday

weekday_pattern = df.groupby('Weekday').agg({
    'Total': ['sum', 'mean', 'count']
}).round(2)

# 按正確順序排序
weekday_order = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']
weekday_pattern = weekday_pattern.reindex(weekday_order)

# 3. 營業時段分析（切分早中晚）
def classify_time(hour):
    if 10 <= hour < 14:
        return '午間(10-14)'
    elif 14 <= hour < 18:
        return '下午(14-18)'
    elif 18 <= hour <= 21:
        return '晚間(18-21)'
    else:
        return '其他'

df['時段'] = df['Hour'].apply(classify_time)
time_analysis = df.groupby('時段')['Total'].agg(['sum', 'mean', 'count'])

# 4. 月度成長分析
monthly = df.groupby('Month').agg({
    'Total': 'sum',
    'Invoice ID': 'count',
    'Gross income': 'sum'
})
monthly['MoM成長率'] = monthly['Total'].pct_change() * 100

# 5. 尖峰時段矩陣（星期 x 時段）
peak_matrix = pd.crosstab(
    df['Weekday'],
    df['時段'],
    values=df['Total'],
    aggfunc='sum'
)

【預測建議輸出】
# 基於分析結果給出建議
recommendations = {
    '最佳營業日': weekday_pattern['Total']['sum'].idxmax(),
    '尖峰時段': time_analysis['sum'].idxmax(),
    '建議促銷日': weekday_pattern['Total']['sum'].idxmin(),
    '預估下月營收': monthly['Total'].mean() * (1 + monthly['MoM成長率'].mean()/100)
}

【DoD】
□ 識別銷售規律
□ 找出尖離峰時段
□ 提供排班建議

【Fallback】
- 日期處理錯誤 → 提供完整日期轉換代碼
- rolling 不懂 → 解釋移動平均概念
```

---

### 📈 Module 3：視覺化大師（60 分鐘）

#### 3-1 基礎圖表製作（14:30-15:00）

```python
【題目】讓數字說故事 - 5 種必學圖表
【情境】簡報不能只有表格，要有圖才專業

【五大圖表】
1. 長條圖：分店營收比較
2. 圓餅圖：產品線佔比
3. 折線圖：每日趨勢
4. 熱力圖：相關性分析
5. 組合圖：多維度展示

【程式碼實作】
import matplotlib.pyplot as plt
import seaborn as sns

# 設定中文字體（避免亂碼）
plt.rcParams['font.sans-serif'] = ['DejaVu Sans']
plt.rcParams['axes.unicode_minus'] = False

# 1. 分店營收長條圖
fig, axes = plt.subplots(2, 3, figsize=(15, 10))

# 子圖1：分店總營收
branch_total = df.groupby('Branch')['Total'].sum()
axes[0, 0].bar(branch_total.index, branch_total.values, color=['#FF6B6B', '#4ECDC4', '#45B7D1'])
axes[0, 0].set_title('Branch Revenue Comparison')
axes[0, 0].set_ylabel('Total Revenue ($)')

# 子圖2：產品線圓餅圖
product_sales = df.groupby('Product line')['Total'].sum()
axes[0, 1].pie(product_sales.values, labels=product_sales.index, autopct='%1.1f%%')
axes[0, 1].set_title('Product Line Distribution')

# 子圖3：每日銷售趨勢
daily = df.groupby('Date')['Total'].sum()
axes[0, 2].plot(daily.index, daily.values, marker='o', markersize=3)
axes[0, 2].set_title('Daily Sales Trend')
axes[0, 2].tick_params(axis='x', rotation=45)

# 子圖4：支付方式分布
payment = df['Payment'].value_counts()
axes[1, 0].barh(payment.index, payment.values, color=['#95E1D3', '#F38181', '#FCE38A'])
axes[1, 0].set_title('Payment Method Distribution')

# 子圖5：評分分布直方圖
axes[1, 1].hist(df['Rating'], bins=20, color='#786FA6', alpha=0.7, edgecolor='black')
axes[1, 1].set_title('Customer Rating Distribution')
axes[1, 1].set_xlabel('Rating')

# 子圖6：熱力圖（相關性）
corr_cols = ['Unit price', 'Quantity', 'Tax 5%', 'Total', 'Rating']
correlation = df[corr_cols].corr()
sns.heatmap(correlation, annot=True, fmt='.2f', cmap='coolwarm', ax=axes[1, 2])
axes[1, 2].set_title('Correlation Heatmap')

plt.tight_layout()
plt.show()

【DoD】
□ 成功產出 5 種圖表
□ 圖表有標題和標籤
□ 配色美觀

【Fallback】
- 中文亂碼 → 使用英文標籤
- 圖表重疊 → 調整 figsize
```

#### 3-2 進階視覺化（15:00-15:30）

```python
【題目】製作管理層儀表板等級的圖表
【情境】CEO 要看的 Dashboard 圖表

【進階圖表】
1. 雙軸圖（營收 + 交易數）
2. 箱型圖（發現異常值）
3. 小提琴圖（分布細節）

【程式碼實作】
# 1. 雙軸圖：營收與交易數趨勢
fig, ax1 = plt.subplots(figsize=(12, 6))

daily_revenue = df.groupby('Date')['Total'].sum()
daily_transactions = df.groupby('Date')['Invoice ID'].count()

color = 'tab:blue'
ax1.set_xlabel('Date')
ax1.set_ylabel('Revenue ($)', color=color)
ax1.plot(daily_revenue.index, daily_revenue.values, color=color, linewidth=2)
ax1.tick_params(axis='y', labelcolor=color)

ax2 = ax1.twinx()
color = 'tab:orange'
ax2.set_ylabel('Number of Transactions', color=color)
ax2.bar(daily_transactions.index, daily_transactions.values, color=color, alpha=0.3)
ax2.tick_params(axis='y', labelcolor=color)

plt.title('Daily Revenue vs Transaction Volume')
fig.tight_layout()

# 2. 箱型圖：各產品線價格分布
plt.figure(figsize=(12, 6))
df.boxplot(column='Total', by='Product line', figsize=(12, 6))
plt.suptitle('Price Distribution by Product Line')
plt.xlabel('Product Line')
plt.ylabel('Transaction Total ($)')

【DoD】
□ 完成至少 1 個進階圖表
□ 圖表能凸顯洞察
```

---

### 🚀 Module 4：Streamlit 儀表板部署（60 分鐘）

#### 4-1 基礎儀表板搭建（15:30-16:00）

```python
【題目】10 分鐘搭建互動式儀表板
【情境】讓老闆自己玩數據，不要一直問你

【儀表板功能】
1. 資料上傳
2. 篩選器（分店/日期/產品）
3. 關鍵指標卡片
4. 互動式圖表
5. 資料下載

【程式碼實作】app.py
import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go

# 設定頁面
st.set_page_config(
    page_title="銷售分析儀表板",
    page_icon="📊",
    layout="wide"
)

# 標題
st.title("🛒 超市銷售分析儀表板")
st.markdown("---")

# 側邊欄：篩選器
st.sidebar.header("篩選條件")

# 讀取資料
@st.cache_data
def load_data():
    df = pd.read_csv('supermarket_sales.csv')
    df['Date'] = pd.to_datetime(df['Date'])
    return df

df = load_data()

# 日期篩選
date_range = st.sidebar.date_input(
    "選擇日期範圍",
    value=(df['Date'].min(), df['Date'].max()),
    min_value=df['Date'].min(),
    max_value=df['Date'].max()
)

# 分店篩選
branches = st.sidebar.multiselect(
    "選擇分店",
    options=df['Branch'].unique(),
    default=df['Branch'].unique()
)

# 產品線篩選
products = st.sidebar.multiselect(
    "選擇產品線",
    options=df['Product line'].unique(),
    default=df['Product line'].unique()
)

# 篩選資料
filtered_df = df[
    (df['Date'].dt.date >= date_range[0]) &
    (df['Date'].dt.date <= date_range[1]) &
    (df['Branch'].isin(branches)) &
    (df['Product line'].isin(products))
]

# 關鍵指標（使用欄位）
col1, col2, col3, col4 = st.columns(4)

with col1:
    total_revenue = filtered_df['Total'].sum()
    st.metric("總營收", f"${total_revenue:,.0f}")

with col2:
    total_transactions = len(filtered_df)
    st.metric("交易筆數", f"{total_transactions:,}")

with col3:
    avg_transaction = filtered_df['Total'].mean()
    st.metric("平均客單價", f"${avg_transaction:.2f}")

with col4:
    avg_rating = filtered_df['Rating'].mean()
    st.metric("平均評分", f"{avg_rating:.1f} ⭐")

# 圖表區域
st.markdown("---")
st.subheader("📊 視覺化分析")

# 兩欄佈局
chart_col1, chart_col2 = st.columns(2)

with chart_col1:
    # 分店營收比較
    branch_revenue = filtered_df.groupby('Branch')['Total'].sum().reset_index()
    fig1 = px.bar(
        branch_revenue,
        x='Branch',
        y='Total',
        title='分店營收比較',
        color='Branch',
        color_discrete_map={'A': '#FF6B6B', 'B': '#4ECDC4', 'C': '#45B7D1'}
    )
    st.plotly_chart(fig1, use_container_width=True)

with chart_col2:
    # 產品線分布
    product_revenue = filtered_df.groupby('Product line')['Total'].sum().reset_index()
    fig2 = px.pie(
        product_revenue,
        values='Total',
        names='Product line',
        title='產品線營收分布'
    )
    st.plotly_chart(fig2, use_container_width=True)

# 時間趨勢圖（全寬）
st.subheader("📈 時間趨勢分析")
daily_sales = filtered_df.groupby('Date')['Total'].sum().reset_index()
fig3 = px.line(
    daily_sales,
    x='Date',
    y='Total',
    title='每日銷售趨勢',
    markers=True
)
fig3.update_traces(line_color='#6C5CE7')
st.plotly_chart(fig3, use_container_width=True)

# 資料表格
st.markdown("---")
st.subheader("📋 詳細資料")

# 顯示篩選後的資料
st.dataframe(
    filtered_df[['Invoice ID', 'Branch', 'Product line', 'Total', 'Date', 'Rating']].head(100),
    use_container_width=True
)

# 下載按鈕
csv = filtered_df.to_csv(index=False)
st.download_button(
    label="📥 下載篩選後資料",
    data=csv,
    file_name='filtered_sales_data.csv',
    mime='text/csv'
)

# 頁尾
st.markdown("---")
st.caption("💡 提示：使用左側篩選器來探索不同維度的資料")

【DoD】
□ 儀表板能在本地運行
□ 篩選器正常運作
□ 圖表能互動
□ 能下載資料

【執行指令】
streamlit run app.py

【Fallback】
- Streamlit 安裝失敗 → 用 pip install streamlit
- 圖表不顯示 → 檢查 plotly 安裝
- 載入太慢 → 使用 @st.cache_data
```

#### 4-2 部署上雲端（16:00-16:30）

```python
【題目】讓全世界都能看到你的分析
【情境】不用 IT 部門，自己就能部署

【部署步驟】
1. 創建 GitHub 帳號（已有則跳過）
2. 創建新 repository
3. 上傳三個檔案：
   - app.py（主程式）
   - requirements.txt（套件清單）
   - supermarket_sales.csv（資料）
4. 連結 Streamlit Cloud
5. 一鍵部署

【requirements.txt】
streamlit==1.28.0
pandas==2.0.0
plotly==5.17.0

【GitHub 操作】
1. 登入 GitHub
2. New repository → "sales-dashboard"
3. Upload files → 拖曳 3 個檔案
4. Commit changes

【Streamlit Cloud 部署】
1. 前往 share.streamlit.io
2. 連結 GitHub 帳號
3. 選擇 repository
4. 選擇 app.py
5. Deploy!

【DoD】
□ 取得公開網址
□ 手機也能開啟
□ 分享給 3 個人測試

【Fallback】
- GitHub 不會用 → 助教代為上傳
- 部署失敗 → 檢查 requirements.txt
- 還是不行 → 至少本地能 demo
```

---

### 🎭 Module 5：Demo Time（30 分鐘）

#### 5-1 準備 2 分鐘 Pitch（16:30-16:45）

```
【展示架構】
1. 問題陳述（20 秒）
   「每月花 8 小時做銷售報表」

2. 解決方案（30 秒）
   「Python 自動化 + 互動式儀表板」

3. Live Demo（60 秒）
   - 打開儀表板網址
   - 操作篩選器
   - 展示圖表互動
   - 下載報表

4. 價值總結（10 秒）
   「每月省 7.5 小時，錯誤率降為 0」

【展示技巧】
- 先展示最酷炫的功能
- 強調前後對比
- 記得講商業價值
```

#### 5-2 互評與慶祝（16:45-17:00）

```
【評分表】
□ 儀表板能正常運作（40%）
□ 至少 3 種分析（30%）
□ 視覺化美觀（20%）
□ 簡報清晰（10%）

【獎項設計】
🏆 最佳視覺獎：圖表最漂亮
💡 最佳洞察獎：發現有趣規律
⚡ 最速完成獎：第一個部署成功
```

---

## ⏱️ 詳細時間節拍控制表

### 節奏控制密技

| 時間點 | 講師動作 | 助教動作 | 注意事項 |
|:-------|:---------|:---------|:---------|
| 每小時 | 確認進度 | 統計完成率 | 低於 60% 要調整 |
| 練習開始 | 設定計時器 | 開始巡場 | 5 分鐘內要看到產出 |
| 剩 10 分鐘 | 提醒時間 | 發 checkpoint | 協助落後學員 |
| 剩 5 分鐘 | 預告下一題 | 收集問題 | 準備 Q&A |
| 練習結束 | 展示標準答案 | 協助未完成者 | 不要延長時間 |

### 救援決策樹

```
學員舉手
    ├─ 環境問題？
    │   └─ 助教處理（2分鐘內）
    ├─ 程式錯誤？
    │   ├─ 語法錯誤 → 直接指出
    │   ├─ 邏輯錯誤 → 給提示
    │   └─ 完全卡住 → 給 checkpoint
    └─ 概念不懂？
        └─ 講師統一講解（影響 >30% 學員）
```

---

## 🛠️ 教學資源準備

### 檔案結構

```
/workshop-sales-v3/
├── 課前準備/
│   ├── 環境安裝指南.pdf
│   ├── Python基礎語法.pdf
│   └── Excel對照表.pdf
├── 資料集/
│   ├── supermarket_sales.csv (1,000筆)
│   ├── supermarket_sales_large.csv (10,000筆挑戰版)
│   └── data_dictionary.txt
├── checkpoints/
│   ├── m0_hello_world.py
│   ├── m1_data_loading.py
│   ├── m1_data_exploration.py
│   ├── m2_branch_analysis.py
│   ├── m2_product_analysis.py
│   ├── m2_time_analysis.py
│   ├── m3_visualization.py
│   ├── m4_streamlit_basic.py
│   └── m4_streamlit_complete.py
├── 解答/
│   ├── complete_notebook.ipynb
│   ├── final_app.py
│   └── requirements.txt
├── 講義/
│   ├── 學員講義.pdf
│   ├── 講師手冊.pdf
│   └── 助教指南.pdf
└── 額外資源/
    ├── prompts_collection.md
    ├── common_errors.md
    └── further_learning.md
```

### 環境需求最小集

```python
# requirements_minimal.txt
pandas==2.0.0
matplotlib==3.7.0
seaborn==0.12.0
streamlit==1.28.0
plotly==5.17.0
openpyxl==3.1.0  # 讀取 Excel
```

---

## 📊 學習成效評估

### 檢核點設計

| 時間 | 檢核項目 | 通過標準 | 未通過處理 |
|:-----|:---------|:---------|:-----------|
| 10:00 | 環境設定 | 90% 能 import | 提供 Colab |
| 11:00 | 資料讀取 | 80% 看到 DataFrame | 發 checkpoint |
| 12:30 | 基礎分析 | 70% 完成 1 項 | 簡化需求 |
| 14:30 | 三大分析 | 60% 完成 2 項 | 專注核心 |
| 15:30 | 視覺化 | 70% 產出圖表 | 提供模板 |
| 16:30 | 儀表板 | 50% 能運行 | 本地 Demo 即可 |

### 學習成果指標

```python
# 可量化指標
beginner_goals = {
    '基礎': '能讀取 CSV 並顯示',  # 100% 應達成
    '初級': '完成 groupby 分析',   # 90% 應達成
    '中級': '產出 3 種圖表',       # 70% 應達成
    '進階': '部署 Streamlit',      # 50% 應達成
    '挑戰': '自訂分析維度'         # 20% 嘗試
}
```

---

## 💡 教學小撇步

### 開場勾子
- 展示「1 行程式碼 = 100 個 VLOOKUP」
- 秀出以前做報表的痛苦截圖
- 「學完這堂課，下週開始每月多 8 小時下班時間」

### 維持動能
- 每 30 分鐘來個「誰做出來了？」
- 小成功就鼓掌（第一個圖表出來）
- 放 BGM 但不要太 high

### 處理挫折
- 「做不出來很正常，我第一次也是」
- 「重點不是完美，是能動」
- 「回去可以用 ChatGPT 繼續學」

### 結尾高潮
- 全班一起倒數部署
- 第一個成功的帶頭歡呼
- 拍大合照 + 儀表板截圖

---

## 🎯 課後延伸路徑

### Level 1：鞏固基礎（第 1 週）
- 用自己公司的資料重做一遍
- 加入 1 個新的分析維度
- 優化圖表配色

### Level 2：功能升級（第 2-3 週）
- 加入資料自動更新
- 增加預測功能
- 整合多個資料源

### Level 3：進階挑戰（第 4 週後）
- 導入機器學習預測
- 串接資料庫
- 設定排程自動化

### 學習資源
- 📚 書籍：《Python for Data Analysis》
- 🎥 影片：YouTube "Streamlit Tutorial"
- 💬 社群：Join Python Taiwan
- 🏆 挑戰：Kaggle Sales Competition

---

## ✅ 開課前終極檢查清單

### D-7 檢查
- [ ] 所有 checkpoint 檔案測試完成
- [ ] 資料集下載並驗證
- [ ] 環境安裝文件發給學員
- [ ] 建立 Discord/Line 群組

### D-3 檢查
- [ ] 確認學員環境安裝狀況（調查表）
- [ ] 助教 briefing（走一遍流程）
- [ ] 準備備用電腦 × 2
- [ ] 測試投影設備

### D-1 檢查
- [ ] 列印簽到表 + 評分表
- [ ] 準備小禮物（最佳 3 名）
- [ ] 檢查 WiFi 密碼
- [ ] 充電線、延長線準備

### 當天檢查
- [ ] 提早 45 分鐘到場
- [ ] 開啟空調（太冷不好學）
- [ ] 音響測試（背景音樂）
- [ ] 準備茶水點心
- [ ] 白板筆 × 3 色

---

## 🚨 緊急應變方案

| 危機狀況 | 應變方案 |
|:---------|:---------|
| WiFi 掛掉 | 手機熱點 + 離線資料集 |
| 講師生病 | 助教頂上 + 播放錄影 |
| 停電 | 筆電電池撐 + 改期 |
| 人數過少 | 改成工作坊討論形式 |
| 人數過多 | 分組競賽模式 |
| 全班進度超前 | 發挑戰題 + 自由專題 |
| 全班進度落後 | 砍掉 Module 4-5 |

---

*Last Updated: 2024.12*
*Version: 3.0 - Sales Analysis Specialization*
*Target: Excel Users → Python Beginners*